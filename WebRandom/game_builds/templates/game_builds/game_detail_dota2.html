{% extends 'game_builds/base.html' %}
<<<<<<< Updated upstream
{% block title %}{{ game.name }} ‚Äì Random Build Generator{% endblock %}

{% block content %}
<div class="container my-5 px-4" style="max-width: 1200px; font-family: 'Segoe UI', sans-serif; color: #fff;">
<style>
    body {
        background: linear-gradient(135deg, #0d0d0d 0%, #1a1a1a 100%);
        color: #fff;
        overflow-x: hidden;
    }

    .neon-title {
        font-size: 3.5rem;
        font-weight: bold;
        text-transform: uppercase;
        text-shadow: 0 0 25px cyan, 0 0 40px cyan;
    }

    .btn-glass, .btn-outline-light {
        background: rgba(255,255,255,0.1);
        border: 2px solid #00f7ff;
        border-radius: 1rem;
        padding: 12px 26px;
        font-size: 1.1rem;
        font-family: 'Bangers', sans-serif;
        transition: all 0.3s ease-in-out;
        box-shadow: 0 0 10px #00f7ff44;
    }

    .btn-glass:hover {
        background: rgba(0,255,255,0.2);
        transform: translateY(-3px);
        box-shadow: 0 0 15px #00f7ff, 0 0 40px #00f7ff;
    }

    .glass {
        background: rgba(255,255,255,0.1);
        border-radius: 1.5rem;
        backdrop-filter: blur(15px);
        box-shadow: 0 0 30px rgba(0, 0, 0, 0.6);
        animation: fadeInUp 0.5s ease;
    }

    .item-card {
        background: rgba(0,0,0,0.25);
        border: 2px solid #00f7ff;
        backdrop-filter: blur(6px);
        border-radius: 1rem;
        padding: 20px;
        margin: 15px;
        transition: all 0.3s ease;
        text-align: center;
    }

    .item-card:hover {
        transform: scale(1.05);
        box-shadow: 0 0 20px #00f7ff, 0 0 35px #00f7ff;
    }

    .loader {
        border: 6px solid rgba(255, 255, 255, 0.2);
        border-top: 6px solid #00f7ff;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite;
        margin: 0 auto;
        display: none;
    }

    @keyframes spin {
        0% { transform: rotate(0deg);}
        100% { transform: rotate(360deg);}
    }

    .role-filter {
        color: #fff;
        font-weight: 600;
    }
</style>

<div class="text-center mb-5">
    <h1 class="neon-title">Dota 2 Build Generator</h1>
    <p class="lead opacity-75">Generate the perfect build, tailored for your role</p>
    
    <div class="d-flex justify-content-center gap-3 mb-4">
        <select id="roleSelect" class="form-select w-auto bg-dark text-white border-info">
            <option value="">All Roles</option>
            <option value="carry">Carry</option>
            <option value="support">Support</option>
            <option value="offlane">Offlane</option>
        </select>
        <button id="generateBtn" class="btn btn-glass">üé≤ Generate Build</button>
        <button id="resetBtn" class="btn btn-outline-light">‚ôªÔ∏è Reset</button>
    </div>

    <div class="loader" id="loader"></div>
</div>

<div id="buildResult" class="glass p-4 mt-5" style="display: none;">
    <div class="text-center mb-4">
        <img id="heroImage" class="hero-image img-fluid" src="" alt="Hero" style="max-height: 200px;">
        <h2 id="heroName" class="mt-3 text-glow"></h2>
        <p id="heroDescription" class="text-muted">Master of time, keeper of secrets.</p>
    </div>

    <div class="row mt-4 justify-content-center">
        <div class="col-12 text-center mb-3">
            <h4 class="text-glow">‚öîÔ∏è Late Game Items</h4>
        </div>
        <div id="lateItems" class="d-flex flex-wrap gap-4 justify-content-center"></div>
    </div>

    <div class="text-center mt-5">
        <button id="downloadBtn" class="btn btn-outline-light border-glow px-4 py-2">‚¨áÔ∏è Download Build</button>
=======

{% block title %}{{ game.name }} - Dota 2 Build{% endblock %}

{% block content %}
<div class="dota2-container" style="background: linear-gradient(to bottom, #0f0f0f, #1a1a1a); color: #fff; padding: 20px; min-height: 100vh;">
    <!-- –õ–æ–≥–æ—Ç–∏–ø -->
    <div class="text-center mb-4">
        <img src="/static/images/dota2_logo.png" alt="Dota 2 Logo" style="max-width: 300px;">
    </div>

    <!-- –ö–Ω–æ–ø–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ -->
    <div class="text-center mb-4">
        <button id="generateBtn" class="btn btn-lg btn-danger shadow" style="font-weight: bold; text-transform: uppercase; padding: 15px 30px; font-size: 1.2rem;">Generate Build</button>
    </div>

    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç –±–∏–ª–¥–∞ -->
    <div id="buildResult" style="display: none;">
        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –≥–µ—Ä–æ—è -->
        <div class="card mb-4 shadow" style="background: rgba(0,0,0,0.85); border: 1px solid #ff4500; border-radius: 10px;">
            <div class="card-header text-white text-center" style="font-size: 1.5rem; text-transform: uppercase; background: rgba(255,69,0,0.8);">
                Hero Build
            </div>
            <div class="card-body text-center">
                <img id="heroImage" src="" alt="Hero" style="max-width: 200px; border: 2px solid #fff; border-radius: 5px;">
                <h4 id="heroName" class="text-warning fw-bold" style="margin-top: 20px; font-size: 2rem;">hero</h4>
            </div>
        </div>

        <!-- –°–µ–∫—Ü–∏—è Late Game Items -->
        <div class="late-items-section" style="position: relative; background: url('/static/images/your_late_items_image.png') no-repeat center center; background-size: contain; height: 300px; border: 1px solid #ff4500; border-radius: 10px; margin-bottom: 20px;">
            <!-- –í–µ—Ä—Ö–Ω–∏–π —Ä—è–¥ -->
            <div id="lateItemsUpper" style="position: absolute; top: 0; left: 0; width: 100%; height: 50%; display: flex; justify-content: center; align-items: flex-end;">
                <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —ç–ª–µ–º–µ–Ω—Ç—ã -->
            </div>
            <!-- –ù–∏–∂–Ω–∏–π —Ä—è–¥ -->
            <div id="lateItemsLower" style="position: absolute; bottom: 0; left: 0; width: 100%; height: 50%; display: flex; justify-content: center; align-items: flex-start;">
                <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —ç–ª–µ–º–µ–Ω—Ç—ã -->
            </div>
        </div>

        <!-- –°–µ–∫—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
        <div id="heroStats" class="card mb-4 shadow" style="background: rgba(0,0,0,0.85); border: 1px solid #ff4500; border-radius: 10px; display: none;">
            <div class="card-body d-flex align-items-center">
                <img id="heroStatsImage" src="" alt="Hero" style="width: 150px; height:150px; object-fit: cover; border-radius: 5px; border: 2px solid #fff;">
                <div class="ms-4 text-white">
                    <h4 id="heroStatsName" class="mb-3">Hero Name</h4>
                    <p id="heroAttack" class="mb-1">Attack: </p>
                    <p id="heroDefense" class="mb-1">Defense: </p>
                    <p id="heroMobility" class="mb-1">Mobility: </p>
                    <p id="heroIntelligence" class="mb-1">Intelligence: </p>
                </div>
            </div>
        </div>
>>>>>>> Stashed changes
    </div>
</div>

<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
<script>
<<<<<<< Updated upstream
    document.addEventListener('DOMContentLoaded', () => {
        const generateBtn = document.getElementById('generateBtn');
        const resetBtn = document.getElementById('resetBtn');
        const loader = document.getElementById('loader');
        const resultBlock = document.getElementById('buildResult');
        const heroImage = document.getElementById('heroImage');
        const heroName = document.getElementById('heroName');
        const lateItems = document.getElementById('lateItems');
        const downloadBtn = document.getElementById('downloadBtn');
        const roleSelect = document.getElementById('roleSelect');

        const showLoader = () => loader.style.display = 'block';
        const hideLoader = () => loader.style.display = 'none';

        const loadBuild = (role = '') => {
            showLoader();
            resultBlock.style.display = 'none';

            const slug = window.location.pathname.split('/')[2];
            const url = `/game/${slug}/generate/${role ? '?role=' + role : ''}`;

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    hideLoader();
                    resultBlock.style.display = 'block';
                    heroImage.src = data.hero_image_png;
                    heroName.textContent = data.hero;
                    lateItems.innerHTML = '';

                    data.late_items.forEach(item => {
                        const card = document.createElement('div');
                        card.className = 'item-card';
                        card.innerHTML = `
                            <img src="${item.image_png}" alt="${item.name}" class="mb-2">
                            <div class="item-name">${item.name}</div>
                            <div class="item-description">${item.description || 'No description available'}</div>
                        `;
                        lateItems.appendChild(card);
                    });

                    localStorage.setItem('lastBuild', JSON.stringify(data));
                });
        };

        generateBtn.addEventListener('click', () => {
            loadBuild(roleSelect.value);
        });

        downloadBtn.addEventListener('click', () => {
            html2canvas(document.querySelector("#buildResult")).then(canvas => {
                const link = document.createElement('a');
                link.download = 'dota2_build.png';
                link.href = canvas.toDataURL();
                link.click();
=======
document.addEventListener('DOMContentLoaded', function() {
    const generateBtn = document.getElementById('generateBtn');
    if (!generateBtn) {
        console.error("–ö–Ω–æ–ø–∫–∞ 'Generate Build' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞");
        return;
    }

    generateBtn.addEventListener('click', function () {
        let parts = window.location.pathname.split('/');
        let slug = parts[2];
        fetch(`/game/${slug}/generate/`)
            .then(response => {
                if (!response.ok) {
                    throw new Error(`Network response was not ok. Status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                console.log("–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±–∏–ª–¥:", data);
                document.getElementById('buildResult').style.display = 'block';

                // –û–±–Ω–æ–≤–ª—è–µ–º –≥–µ—Ä–æ—è
                const heroImage = document.getElementById('heroImage');
                const heroName = document.getElementById('heroName');
                if (heroImage && heroName) {
                    heroImage.src = data.hero_image_png || data.hero_image || "/static/images/heroes/default.png";
                    heroName.textContent = data.hero;
                }

                // –û–±–Ω–æ–≤–ª—è–µ–º Late Game Items
                function updateLateItems(items) {
                    const upperContainer = document.getElementById('lateItemsUpper');
                    const lowerContainer = document.getElementById('lateItemsLower');
                    if (!upperContainer || !lowerContainer) {
                        console.error("–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è lateItems –Ω–µ –Ω–∞–π–¥–µ–Ω—ã");
                        return;
                    }
                    upperContainer.innerHTML = '';
                    lowerContainer.innerHTML = '';

                    items.slice(0, 3).forEach(item => {
                        const li = document.createElement('li');
                        li.className = 'item-card me-2 text-center';
                        li.innerHTML = `
                            <div class="card" style="width: 100px; background: rgba(255,255,255,0.1);">
                                <img src="${item.image_png}" alt="${item.name}" class="card-img-top img-fluid" style="width:100px; height:100px; object-fit: contain; border-radius: 0;">
                            </div>
                        `;
                        upperContainer.appendChild(li);
                    });

                    items.slice(3, 6).forEach(item => {
                        const li = document.createElement('li');
                        li.className = 'item-card me-2 text-center';
                        li.innerHTML = `
                            <div class="card" style="width: 100px; background: rgba(255,255,255,0.1);">
                                <img src="${item.image_png}" alt="${item.name}" class="card-img-top img-fluid" style="width:100px; height:100px; object-fit: contain; border-radius: 0;">
                            </div>
                        `;
                        lowerContainer.appendChild(li);
                    });
                }

                updateLateItems(data.late_items);

                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                if (data.stats) {
                    const heroStatsCard = document.getElementById('heroStats');
                    document.getElementById('heroStatsImage').src = data.hero_image_png || data.hero_image || "/static/images/heroes/default.png";
                    document.getElementById('heroStatsName').textContent = data.hero;
                    document.getElementById('heroAttack').textContent = "Attack: " + data.stats.attack;
                    document.getElementById('heroDefense').textContent = "Defense: " + data.stats.defense;
                    document.getElementById('heroMobility').textContent = "Mobility: " + data.stats.mobility;
                    document.getElementById('heroIntelligence').textContent = "Intelligence: " + data.stats.intelligence;
                    heroStatsCard.style.display = 'block';
                }
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞:', error);
                alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –±–∏–ª–¥–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.");
>>>>>>> Stashed changes
            });
        });

        resetBtn.addEventListener('click', () => {
            resultBlock.style.display = 'none';
            localStorage.removeItem('lastBuild');
        });

        // –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±–∏–ª–¥–∞
        const saved = localStorage.getItem('lastBuild');
        if (saved) {
            const data = JSON.parse(saved);
            heroImage.src = data.hero_image_png;
            heroName.textContent = data.hero;
            lateItems.innerHTML = '';
            data.late_items.forEach(item => {
                const card = document.createElement('div');
                card.className = 'item-card';
                card.innerHTML = `
                    <img src="${item.image_png}" alt="${item.name}" class="mb-2">
                    <div class="item-name">${item.name}</div>
                    <div class="item-description">${item.description || 'No description available'}</div>
                `;
                lateItems.appendChild(card);
            });
            resultBlock.style.display = 'block';
        }
    });
</script>
</div>
{% endblock %}
