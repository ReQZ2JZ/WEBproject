{% extends 'game_builds/base.html' %}

{% block content %}
<div class="container text-center my-5">
    <h2>üéÆ League of Legends: –†–∞–Ω–¥–æ–º–Ω—ã–π –±–∏–ª–¥</h2>

    <button id="generate-btn" class="btn btn-primary my-4">üé≤ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –±–∏–ª–¥</button>

    <div id="build-result" class="build-result"></div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
console.log("üî• –°–ö–†–ò–ü–¢ –ü–û–î–ö–õ–Æ–ß–ï–ù");

const button = document.getElementById("generate-btn");

if (button) {
    button.addEventListener("click", function () {
        console.log("üöÄ –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ");

        fetch(window.location.pathname + "generate/")
            .then(response => response.json())
            .then(data => {
                console.log("üì¶ –ü–æ–ª—É—á–µ–Ω–æ:", data);

                if (data.error) {
                    document.getElementById("build-result").innerHTML =
                        `<p class="text-danger">${data.error}</p>`;
                    return;
                }

                const championHtml = `
                    <h3>–ß–µ–º–ø–∏–æ–Ω: ${data.champion.name}</h3>
                    <img src="${data.champion.image}" alt="${data.champion.name}" style="height: 150px;" class="mb-4">
                `;

                const itemsHtml = data.items.map(item => `
                    <div class="d-inline-block mx-2 text-center">
                        <img src="${item.image}" alt="${item.name}" style="height: 80px;"><br>
                        <small>${item.name}</small>
                    </div>
                `).join('');

                document.getElementById("build-result").innerHTML =
                    championHtml + `<h4 class="mt-4">–ü—Ä–µ–¥–º–µ—Ç—ã:</h4>` + itemsHtml;
            })
            .catch(error => {
                console.error("‚ùå –û—à–∏–±–∫–∞:", error);
                document.getElementById("build-result").innerHTML =
                    `<p class="text-danger">–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –±–∏–ª–¥–∞.</p>`;
            });
    });
} else {
    console.error("üö´ –ö–Ω–æ–ø–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!");
}
</script>
{% endblock %}
